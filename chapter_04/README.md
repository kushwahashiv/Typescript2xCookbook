# About this example
This chapter contains recipes to help you to
master the usage of modules.

The same application, a library called ndrscr which is inspired by underscore.js
is implemented many times using different kinds of modules both (internal and external).

```
── src
│   ├── module_definitions
│   │   ├── design_time
│   │   │   ├── external
│   │   │   │   ├── es6
│   │   │   │   └── external
│   │   │   └── internal
│   │   │       ├── internal
│   │   │       └── namespaces
│   │   └── run_time
│   │       ├── external
│   │       │   ├── amd
│   │       │   ├── commonjs
│   │       │   ├── es6
│   │       │   ├── systemjs
│   │       │   └── umd
│   │       └── internal
│   │           ├── internal
│   │           └── namespaces
│   └── module_loaders
│       ├── browserify
│       ├── requirejs
│       ├── systemjs
│       └── webpack
├── tsconfig.json
├── tsd.json
└── typings
    └── tsd.d.ts
```

The examples also showcase how to compile these files (take a look to the gulpfile.js)
and how to run them on Node.js (take a look to the node folder) and a web
browser (take a look to the browser folder).

# How to run the example?

Open a console and clone the following Git repository:

```
$ git https://github.com/kushwahashiv/Typescript2xCookbook.git
```

Navigate to the `chapter_03` folder:

```
$ cd TypescriptCookbook/chapter_03
```

Install node modules:

```
$ npm install
```

Install the TypeScript type definitions:

```
$ tsd reinstall -so
```

Run one of the gulp tasks:

```
$ gulp build-internal
$ gulp build-namespaces

$ gulp build-es6-to-amd
$ gulp build-es6-to-commonjs
$ gulp build-es6-to-umd
$ gulp build-es6-to-systemjs
$ gulp build-external-to-amd
$ gulp build-external-to-commonjs
$ gulp build-external-to-umd
$ gulp build-external-to-systemjs

$ gulp bundle-commonjs-with-browserify
$ gulp bundle-amd-with-requirejs
$ gulp bundle-es6-with-webpack

$ gulp serve
```

# Run-time vs. Design-time modules
TypeScript allow us to use multiple module definition in two different moments in time during the application life cycle:

- **Design-time** | /src/module_definitions/design_time/
- **Run-time** | /src/module_definitions/run_time/

This means that sometimes we will use a module definition syntax in a TypeScript file (at design-time) but it will be compiled into a JavaScript file that uses a different module definition syntaxt (at run-time).

# Internal vs. External modules
In TypeScript we can use multiple module definition syntaxes at design-time and run-time. These module definition syntaxes are categorized in two main groups:

 - **Internal modules** | /src/module_definitions/design_time/internal/
 - **External modules** | /src/module_definitions/design_time/external/

Each of those categories contain an old and a new syntax.

## Design time | **Internal modules**
We can consider as internal modules modules declared using the following syntaxes:

  - **Internal modules (legacy)** | /src/module_definitions/design_time/internal/internal
  - **Namespaces** | /src/module_definitions/design_time/internal/namespaces

## Design time | **External modules**
We can consider as internal modules modules declared using the following syntaxes:

  - **External modules (legacy)** | /src/module_definitions/design_time/external/external
  - **ES6 modules** | /src/module_definitions/design_time/external/es6

## Run time | **Internal modules**
Internal TypeScript modules can be compiled into one single JavaScript file using the `--out` compilation flag. This can be applied to both internal modules (legacy):

```
$ gulp build-internal
```
And namespaces:
```
$ gulp build-namespaces
```

##  Run time | External modules | **AMD**
The AMD modules can be generated by the TypeScript compiler
using one of the following commands.

Use the following command to compile the TypeScript files using ES6
modules at design-time into JavaScript files using AMD modules:
```
$ gulp build-es6-to-amd
```

Use the following command to compile the TypeScript files using external
modules at design-time into JavaScript files using AMD modules:
```
$ gulp build-external-to-amd
```

##  Run time | External modules | **CommonJS**
The CommonJS modules can be generated by the TypeScript compiler
using one of the following commands.

Use the following command to compile the TypeScript files using ES6
modules at design-time into JavaScript files using CommonJS modules:
```
$ gulp build-es6-to-commonjs
```

Use the following command to compile the TypeScript files using external
modules at design-time into JavaScript files using CommonJS modules:
```
$ gulp build-external-to-commonjs
```

You can also create bundled libraries composed of
CommonJS modules using Browserify.
```
$ gulp bundle-commonjs-with-browserify
```

##  Run time | External modules | **UMD**
The UMD modules can be generated by the TypeScript compiler
using one of the following commands.

Use the following command to compile the TypeScript files using ES6
modules at design-time into JavaScript files using UMD modules:

```
$ gulp build-es6-to-umd
```

Use the following command to compile the TypeScript files using external
modules at design-time into JavaScript files using UMD modules:

```
$ gulp build-external-to-umd
```

UMD modules can be loaded by both AMD and CommonJS loaders like AMD. This
chapter includes a demo that showcases how to load UMD modules with requirejs.

```
$ gulp bundle-amd-with-requirejs
```

##  Run time | External modules | **SystemJS**
The SystemJS modules can be generated by the TypeScript compiler
using one of the following commands.

Use the following command to compile the TypeScript files using ES6
modules at design-time into JavaScript files using SystemJS modules:

```
$ gulp build-es6-to-systemjs
```

Use the following command to compile the TypeScript files using external
modules at design-time into JavaScript files using SystemJS modules:

```
$ gulp build-external-to-systemjs
```

##  Run time | External modules | **ES6**
The ES6 modules can be generated by the TypeScript compiler
using one of the following commands.

Use the following command to compile the TypeScript files using ES6
modules at design-time into JavaScript files using ES6 modules:

```
$ gulp build-es6-to-es6
```

Use the following command to compile the TypeScript files using external
modules at design-time into JavaScript files using ES6 modules:

```
$ gulp build-external-to-es6
```

We can run ES6 modules in a browser creating a library with webpack:

```
$ gulp bundle-es6-with-webpack
```

# Run the application in a web browser

```
$ gulp serve
```

Navigate to (if not open automatically by gulp):

```
http://localhost:8000/browser/examples.html
```

Use the select input to see the TypeScript code and JavaScript
code of each of the examples in chapter 03.

# Run the application in node

You need to generate CommonJS modules before running the Node.js examples:
```
gulp build-es6-to-commonjs
```
Or using external modules (legacy):
```
$ gulp build-external-to-commonjs
```
You also need to run the following task to generate a Browserify bundle:
```
$ gulp bundle-commonjs-with-browserify
```
You can then run the node example that loads the CommonJS modules:
```
$ node ./node/commonjs.js
```
The one that uses the Browserify bundle:
```
$ node ./node/browserify.js
```
Or the one that uses the UMD modules:
```
$ node ./node/umd.js
```
